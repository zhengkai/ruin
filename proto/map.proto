syntax = "proto3";
package pb;

import "mob.proto";
import "asset.proto";
import "sprite.proto";

message MapCellTile {
	Tileset.Name name = 1;
	uint32 id = 2;
}

message MapCell {
	uint32 id = 1;
	MapCellTile tile = 2;
}

message MapTrigger {
	uint32 id = 1;
	oneof trigger {
		MapTriggerGate gate = 2;
		MapTriggerGate exit = 3;
		MapTriggerWater water = 4;
	}
}

message MapTriggerGate {
	Zone.Name zone = 1;
	float x = 2;
	float y = 3;
}

message MapTriggerWater {
	float drag = 1;
}

message MapMob {
	Mob.Type type = 1;
	SpriteBox.Name sprite = 5;
	float x = 2;
	float y = 3;
	float scale = 4;
}

message Map {
	enum Name {
		unknown = 0;
		map2 = 2;
		map3 = 3;
		mapWell = 4;
	}
	Map.Name name = 1;
	uint32 w = 2;
	uint32 h = 3;
	repeated MapCell terrain = 4;
}

message ZoneBackgroundTile {
	float loopCnt = 1;
}

message ZoneBackground {
	uint32 index = 1;
	string path = 2;
	oneof type {
		ZoneBackgroundTile tile = 3;
	}
}

message Zone {
	enum Name {
		unknown = 0;
		zone2 = 2;
		zone3 = 3;
		zoneWell = 4;
	}
	Zone.Name name = 1;
	Map.Name map = 2;
	repeated MapTrigger trigger = 3;
	repeated MapMob mob = 4;
	repeated ZoneBackground background = 5;
}
